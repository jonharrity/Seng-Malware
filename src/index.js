const {
  spawn
} = require("child_process");
const os = require("os");
const {app} = require("electron");
const {shell} = require("electron");
const path = require('path');
const process = require('process');
process.chdir('\ClamAV');
// const ls = spawn("ls");
//
// function test() {
//   alert("it worked!");
// }
//
// ls.stdout.on("data", chuck => {
//   console.log(chuck.toString());
// });
//
// // ls.stderr.pipe(dest);
//
// ls.on("close", code => {
//   console.log(`child process exited with code ${code}`);
// });

function openNav() {
  document.getElementById("sidenav").style.width = "200px";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "0";
}

function changeTab(evt, tabname) {
  console.log(`open ${tabname}`);
  var i, tabcontent;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  document.getElementById(tabname).style.display = "block";
  closeNav();
}

function deepScan() {
  console.log(`clamscan ${os.homedir()}`);  //Users default directory
  console.log(`${path.normalize(__dirname)}`);    //Seng-Malware\src
  console.log(`Starting directory: ${process.cwd()}`);

  const deepscan = spawn("clamscan", ["-r"]);
  const out = document.getElementById("deepscanout");
  out.value += "Starting scan...\n";

  deepscan.stdout.on("data", chuck => {
    out.value += `${chuck.toString()}\n`;
    out.scrollTop = out.scrollHeight;
  });

  deepscan.on("close", code => {
    const out = document.getElementById("deepscanout");
    out.value += `Done\n`;
  })

}

function shallowScan() {
  // console.log(`clamscan ${os.homedir()}`);
  //
  // const shallowscan = spawn(process.env.comspec, ['dir', 'clamav']);
  // const out = document.getElementById("shallowscanout");
  //
  // shallowscan.stdout.on("data", chuck => {
  //   out.value += `${chuck.toString()}\n`;
  //   out.scrollTop = out.scrollHeight;
  // });
  //
  // shallowscan.on("close", code => {
  //   const out = document.getElementById("shallowscanout");
  //   out.value += `Done\n`;
  // })
}
